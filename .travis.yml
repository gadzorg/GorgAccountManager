language: ruby

cache:
  bundler: true
  directories:
    - /tmp/cache
rvm:
  - 2.2.6
before_install: gem install bundler -v 1.14.5
install: bundle install --jobs=3 --retry=3 --deployment --without development
services:
  - mysql
before_script:
  - mysql -e 'create database myapp_test;'
  - mysql < db/soce_test_db_schema.sql
  - cp config/database.travis.yml config/database.yml
  - cp config/secrets.travis.yml config/secrets.yml
script:  
  - RAILS_ENV=test bundle exec rake db:migrate
  - RAILS_ENV=test bundle exec rspec spec/
  - RAILS_ENV=test bundle exec cucumber